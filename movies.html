<!-- 
    ============================================
    PAGE FILMS - CINETECH
    ============================================
    Page d√©di√©e √† l'affichage de tous les films disponibles
    
    Caract√©ristiques :
    - Affichage des films populaires par pages (20 films par page)
    - Syst√®me de pagination complet (Pr√©c√©dent / Suivant)
    - Num√©rotation des pages (Page 1, Page 2, etc.)
    - Navigation infinie (TMDB propose des milliers de pages)
    - Boutons d√©sactiv√©s selon contexte :
      * "Pr√©c√©dent" d√©sactiv√© sur page 1
      * "Suivant" d√©sactiv√© sur derni√®re page (si applicable)
    
    Source des donn√©es :
    - API TMDB (The Movie Database)
    - Endpoint : /discover/movie?page=X
    - Param√®tres :
      * language=fr-FR (contenu en fran√ßais)
      * sort_by=popularity.desc (tri par popularit√©)
      * page=X (num√©ro de page)
    
    Fonctionnalit√©s :
    - Cartes de films cliquables vers page de d√©tails
    - Bouton favori sur chaque carte (‚ù§Ô∏è)
    - Note affich√©e avec √©toile (‚≠ê)
    - Images poster en haute qualit√©
    - Recherche disponible via header
    - Responsive (s'adapte √† tous les √©crans)
    
    Gestion de l'√©tat :
    - Variable currentPage stock√©e en JavaScript
    - URL ne change pas (pas de query string)
    - Pas de sauvegarde de la page en localStorage
    - Retour √† la page 1 √† chaque rechargement
-->

<!-- D√©claration du type de document HTML5 -->
<!DOCTYPE html>

<!-- 
    √âl√©ment racine HTML
    lang="fr" = langue fran√ßaise pour accessibilit√© et SEO
-->
<html lang="fr">

<head>
    <!-- 
        ============================================
        EN-T√äTE DU DOCUMENT (m√©tadonn√©es)
        ============================================
    -->
    
    <!-- 
        Encodage UTF-8
        Permet affichage correct des caract√®res accentu√©s et emojis
    -->
    <meta charset="UTF-8">
    
    <!-- 
        Configuration responsive
        width=device-width = largeur adaptative √† l'appareil
        initial-scale=1.0 = zoom par d√©faut √† 100%
        Crucial pour affichage mobile correct
    -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- 
        Titre de la page
        Affich√© dans l'onglet du navigateur
        Important pour SEO et UX
    -->
    <title>Films - Cinetech</title>
    
    <!-- 
        Lien vers feuille de style CSS
        Contient tous les styles visuels de l'application
    -->
    <link rel="stylesheet" href="css/style.css">
</head>

<!-- 
    Corps du document
    Contient tout le contenu visible de la page
-->
<body>
    <!-- 
        ============================================
        HEADER (EN-T√äTE) - Navigation principale
        ============================================
        Header sticky identique sur toutes les pages
        Reste visible en haut lors du scroll (position: sticky en CSS)
    -->
    <header>
        <!-- 
            Container centralis√©
            Classe CSS r√©utilisable qui :
            - Centre le contenu horizontalement
            - Limite la largeur maximale
            - Ajoute du padding lat√©ral
        -->
        <div class="container">
            <!-- 
                Conteneur flexbox pour disposition horizontale
                CSS : display: flex + justify-content: space-between
                Organisation : Logo | Navigation | Recherche
            -->
            <div class="header-content">
                <!-- 
                    Logo Cinetech
                    H1 = titre principal pour SEO
                    üé¨ = emoji cin√©ma pour identit√© visuelle
                    Lien vers page d'accueil (convention UX)
                -->
                <h1 class="logo"><a href="index.html">üé¨ Cinetech</a></h1>
                
                <!-- 
                    Navigation principale
                    Balise s√©mantique <nav> pour accessibilit√©
                -->
                <nav>
                    <!-- 
                        Liste de liens de navigation
                        CSS transform en menu horizontal
                    -->
                    <ul>
                        <!-- Lien vers page d'accueil -->
                        <li><a href="index.html">Accueil</a></li>
                        
                        <!-- 
                            Lien vers page des films (page actuelle)
                            class="active" = style CSS sp√©cial
                            Indication visuelle : couleur rouge + soulignement
                            Montre √† l'utilisateur o√π il se trouve
                        -->
                        <li><a href="movies.html" class="active">Films</a></li>
                        
                        <!-- Lien vers page des s√©ries -->
                        <li><a href="series.html">S√©ries</a></li>
                        
                        <!-- Lien vers page des favoris -->
                        <li><a href="favorites.html">Favoris</a></li>
                    </ul>
                </nav>
                
                <!-- 
                    Conteneur de la barre de recherche
                    Position relative en CSS pour dropdown en absolute
                -->
                <div class="search-container">
                    <!-- 
                        Input de recherche
                        id="searchInput" = cibl√© par JavaScript (search.js)
                        √âcoute l'√©v√©nement keyup pour recherche instantan√©e
                        placeholder = texte indicatif gris
                    -->
                    <input type="text" id="searchInput" placeholder="Rechercher un film ou une s√©rie...">
                    
                    <!-- 
                        Conteneur des r√©sultats de recherche
                        Vide par d√©faut, rempli dynamiquement par JavaScript
                        Affich√© en dropdown (position absolute) sous l'input
                    -->
                    <div id="searchResults" class="search-results"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- 
        ============================================
        MAIN (CONTENU PRINCIPAL)
        ============================================
        Balise s√©mantique pour le contenu principal de la page
        Une seule balise <main> par page
    -->
    <main>
        <!-- 
            ============================================
            SECTION : GRILLE DES FILMS
            ============================================
            Section unique de cette page
            Affiche tous les films disponibles avec pagination
            
            Flux de donn√©es :
            1. Chargement de la page HTML
            2. Ex√©cution de movies.js (module ES6)
            3. Appel API TMDB : GET /discover/movie?page=1
            4. R√©ception JSON avec 20 films + infos de pagination
            5. Cr√©ation de 20 cartes HTML
            6. Injection dans #moviesGrid
            7. Configuration des boutons de pagination
            
            R√©ponse API TMDB (structure) :
            {
              "page": 1,
              "results": [
                {
                  "id": 550,
                  "title": "Fight Club",
                  "poster_path": "/pB8BM7pdSp6B6Ih7QZ4DrQ3PmJK.jpg",
                  "vote_average": 8.4,
                  "release_date": "1999-10-15",
                  "overview": "Un employ√© de bureau..."
                },
                // ... 19 autres films
              ],
              "total_pages": 500,
              "total_results": 10000
            }
            
            Interaction utilisateur :
            - Clic sur carte ‚Üí Redirection vers detail.html?id=550&type=movie
            - Clic sur bouton ‚ù§Ô∏è ‚Üí Ajout/retrait des favoris (localStorage)
            - Clic sur "Suivant" ‚Üí Chargement page 2
            - Clic sur "Pr√©c√©dent" ‚Üí Retour page 1
        -->
        <section class="section">
            <!-- Container pour centrer le contenu -->
            <div class="container">
                <!-- 
                    Titre de la page
                    Classe .page-title = style sp√©cifique pour titres de pages
                    (Plus grand et plus espacer que .section-title)
                -->
                <h2 class="page-title">Tous les Films</h2>
                
                <!-- 
                    Grille de films
                    
                    Attributs :
                    - id="moviesGrid" = cibl√© par JavaScript pour injection dynamique
                    - class="media-grid" = grille CSS responsive
                    
                    CSS Grid configuration :
                    display: grid;
                    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
                    gap: 1.5rem;
                    
                    Explication CSS Grid :
                    - repeat() = r√©p√®te le pattern de colonnes
                    - auto-fill = cr√©e autant de colonnes que possible
                    - minmax(200px, 1fr) = largeur min 200px, max 1 fraction de l'espace
                    - R√©sultat : grille responsive automatique
                      * Desktop (1200px+) : 5-6 cartes par ligne
                      * Tablette (768px) : 3-4 cartes par ligne
                      * Mobile (480px) : 2 cartes par ligne
                    
                    Contenu dynamique :
                    - Message "Chargement..." par d√©faut
                    - Remplac√© par 20 cartes une fois les donn√©es re√ßues
                    - Chaque carte contient :
                      * Image poster (300x450px)
                      * Titre du film
                      * Note avec √©toile (‚≠ê 8.4/10)
                      * Bouton favori (‚ù§Ô∏è ou ü§ç selon √©tat)
                      * Lien cliquable vers page de d√©tails
                -->
                <div id="moviesGrid" class="media-grid">
                    <!-- 
                        Message de chargement par d√©faut
                        Classe .loading = style CSS (centr√©, gris, padding)
                        Affich√© pendant l'appel API (quelques millisecondes)
                        Supprim√© par JavaScript d√®s r√©ception des donn√©es
                    -->
                    <div class="loading">Chargement...</div>
                </div>
                <!-- 
                    ============================================
                    PAGINATION
                    ============================================
                    Syst√®me de navigation entre les pages de films
                    Permet de parcourir les milliers de films de TMDB
                    
                    Structure : [Pr√©c√©dent] [Page X] [Suivant]
                    
                    Comportement dynamique g√©r√© par JavaScript (movies.js) :
                    
                    1. BOUTON "PR√âC√âDENT" :
                       - D√©sactiv√© (disabled) sur page 1
                       - Actif sur pages 2+
                       - Clic : currentPage-- puis nouvel appel API
                       - Scroll automatique en haut de page
                    
                    2. INDICATEUR "PAGE X" :
                       - Affiche le num√©ro de page actuelle
                       - Mis √† jour apr√®s chaque changement
                       - Peut afficher "Page X sur Y" (optionnel)
                       - Texte en gras (font-weight: bold en CSS)
                    
                    3. BOUTON "SUIVANT" :
                       - Actif tant qu'il reste des pages
                       - D√©sactiv√© si page actuelle = derni√®re page
                       - Clic : currentPage++ puis nouvel appel API
                       - Scroll automatique en haut de page
                    
                    Gestion de l'√©tat :
                    - Variable JavaScript : currentPage = 1 (initial)
                    - Incr√©ment√©e/d√©cr√©ment√©e selon navigation
                    - Pas de persistance (retour √† page 1 au rechargement)
                    
                    Attribut :disabled (g√©r√© par JavaScript) :
                    - button.disabled = true ‚Üí Bouton gris et non cliquable
                    - CSS : opacity: 0.5 + cursor: not-allowed
                    
                    Optimisations UX :
                    - Chargement rapide (quelques ms)
                    - Feedback visuel (loading pendant appel API)
                    - Smooth scroll vers le haut
                    - Touches clavier (optionnel : fl√®ches gauche/droite)
                    
                    Alternatives possibles :
                    - Infinite scroll (chargement automatique)
                    - Num√©ros de pages cliquables (1, 2, 3, ...)
                    - "Charger plus" (append au lieu de replace)
                    - URL avec query string (?page=2)
                -->
                <div class="pagination">
                    <!-- 
                        Bouton "Pr√©c√©dent"
                        
                        Attributs :
                        - id="prevPage" = cibl√© par JavaScript pour addEventListener
                        - class="btn-pagination" = style CSS des boutons de pagination
                        
                        Ic√¥ne :
                        - ‚Üê = fl√®che gauche (entit√© HTML : &larr;)
                        - Indique direction de navigation
                        
                        JavaScript associe :
                        prevPage.addEventListener('click', () => {
                          if (currentPage > 1) {
                            currentPage--;
                            loadMovies(currentPage);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                          }
                        });
                        
                        √âtat initial :
                        - D√©sactiv√© (page 1)
                        - JavaScript ajoute prevPage.disabled = true
                    -->
                    <button id="prevPage" class="btn-pagination">‚Üê Pr√©c√©dent</button>
                    
                    <!-- 
                        Indicateur de page
                        
                        Balise <span> = inline, pas de nouvelle ligne
                        id="pageInfo" = mis √† jour par JavaScript
                        
                        Contenu dynamique :
                        - Par d√©faut : "Page 1"
                        - Apr√®s clic Suivant : "Page 2", "Page 3", etc.
                        - JavaScript : pageInfo.textContent = `Page ${currentPage}`
                        
                        Variantes possibles :
                        - "Page 1 sur 500"
                        - "1 / 500"
                        - "Page 1 (10 000 r√©sultats)"
                    -->
                    <span id="pageInfo">Page 1</span>
                    
                    <!-- 
                        Bouton "Suivant"
                        
                        Attributs :
                        - id="nextPage" = cibl√© par JavaScript
                        - class="btn-pagination" = style CSS identique √† Pr√©c√©dent
                        
                        Ic√¥ne :
                        - ‚Üí = fl√®che droite (entit√© HTML : &rarr;)
                        - Indique direction de navigation
                        
                        JavaScript associe :
                        nextPage.addEventListener('click', () => {
                          if (currentPage < totalPages) {
                            currentPage++;
                            loadMovies(currentPage);
                            window.scrollTo({ top: 0, behavior: 'smooth' });
                          }
                        });
                        
                        √âtat initial :
                        - Actif (il y a des pages suivantes)
                        - D√©sactiv√© uniquement si currentPage === totalPages
                    -->
                    <button id="nextPage" class="btn-pagination">Suivant ‚Üí</button>
                </div>
            </div>
        </section>
    </main>

    <!-- 
        ============================================
        FOOTER (PIED DE PAGE)
        ============================================
        Footer identique sur toutes les pages
    -->
    <footer>
        <!-- Container pour centrer le contenu -->
        <div class="container">
            <!-- 
                Copyright et attribution TMDB
                &copy; = entit√© HTML pour symbole ¬© (copyright)
                Attribution obligatoire selon conditions TMDB API
            -->
            <p>&copy; 2025 Cinetech. Donn√©es fournies par TMDB.</p>
        </div>
    </footer>

    <!-- 
        ============================================
        SCRIPT JAVASCRIPT - MODULE ES6
        ============================================
        Chargement du fichier JavaScript sp√©cifique √† la page films
        
        type="module" = Active le mode module ES6
        Avantages :
        - Import/export de modules
        - Mode strict automatique
        - Chargement diff√©r√© (defer)
        - Port√©e isol√©e (pas de pollution globale)
        
        Fichier movies.js contient la classe MoviesPage :
        
        ============================================
        ARCHITECTURE DU CODE (movies.js)
        ============================================
        
        1. IMPORTS DE MODULES
           import { config } from './config.js'
           import { API } from './api.js'
           import { StorageManager } from './storage.js'
           import { UIManager } from './ui.js'
           import { initSearch } from './search.js'
           
        2. CLASSE MOVIESPAGE
           class MoviesPage {
             constructor() {
               this.currentPage = 1;        // Page actuelle
               this.totalPages = 0;          // Total de pages disponibles
               this.api = new API();         // Instance API
               this.ui = new UIManager();    // Instance UI
               this.storage = new StorageManager(); // Gestion favoris
             }
           }
           
        3. M√âTHODE INIT (INITIALISATION)
           async init() {
             // Charge la premi√®re page de films
             await this.loadMovies(1);
             
             // Configure les √©couteurs d'√©v√©nements
             this.setupEventListeners();
             
             // Initialise la recherche
             initSearch();
           }
           
        4. M√âTHODE LOADMOVIES (CHARGEMENT DES FILMS)
           async loadMovies(page) {
             // Affiche le loading
             this.ui.showLoading('#moviesGrid');
             
             try {
               // Appel API TMDB
               const data = await this.api.getPopularMovies(page);
               
               // Extraction des donn√©es
               this.totalPages = data.total_pages;
               const movies = data.results;
               
               // Cr√©ation des cartes HTML
               const container = document.getElementById('moviesGrid');
               container.innerHTML = '';
               
               movies.forEach(movie => {
                 const card = this.ui.createMediaCard(movie, 'movie');
                 container.appendChild(card);
               });
               
               // Mise √† jour de la pagination
               this.updatePagination();
               
             } catch (error) {
               console.error('Erreur:', error);
               this.ui.showError('#moviesGrid', 'Erreur de chargement');
             }
           }
           
        5. M√âTHODE UPDATEPAGINATION (MAJ PAGINATION)
           updatePagination() {
             // R√©f√©rences DOM
             const prevBtn = document.getElementById('prevPage');
             const nextBtn = document.getElementById('nextPage');
             const pageInfo = document.getElementById('pageInfo');
             
             // Mise √† jour du texte
             pageInfo.textContent = `Page ${this.currentPage}`;
             
             // Gestion du bouton Pr√©c√©dent
             prevBtn.disabled = this.currentPage === 1;
             
             // Gestion du bouton Suivant
             nextBtn.disabled = this.currentPage >= this.totalPages;
           }
           
        6. M√âTHODE SETUPEVENTLISTENERS (√âCOUTEURS)
           setupEventListeners() {
             // Bouton Pr√©c√©dent
             document.getElementById('prevPage').addEventListener('click', () => {
               if (this.currentPage > 1) {
                 this.currentPage--;
                 this.loadMovies(this.currentPage);
                 window.scrollTo({ top: 0, behavior: 'smooth' });
               }
             });
             
             // Bouton Suivant
             document.getElementById('nextPage').addEventListener('click', () => {
               if (this.currentPage < this.totalPages) {
                 this.currentPage++;
                 this.loadMovies(this.currentPage);
                 window.scrollTo({ top: 0, behavior: 'smooth' });
               }
             });
             
             // D√©l√©gation d'√©v√©nements pour boutons favoris
             document.addEventListener('click', (e) => {
               if (e.target.classList.contains('favorite-btn')) {
                 this.handleFavoriteClick(e.target);
               }
             });
           }
           
        7. M√âTHODE HANDLEFAVORITECLICK (FAVORIS)
           handleFavoriteClick(button) {
             const card = button.closest('.media-card');
             const mediaId = card.dataset.id;
             const mediaType = 'movie';
             
             // Toggle favori
             if (this.storage.isFavorite(mediaId)) {
               this.storage.removeFavorite(mediaId);
               button.classList.remove('active');
             } else {
               const mediaData = {
                 id: mediaId,
                 type: mediaType,
                 title: card.querySelector('h3').textContent,
                 poster_path: card.querySelector('img').src,
                 vote_average: parseFloat(card.dataset.rating)
               };
               this.storage.addFavorite(mediaData);
               button.classList.add('active');
             }
           }
           
        8. INSTANCIATION ET LANCEMENT
           // Cr√©ation de l'instance
           const moviesPage = new MoviesPage();
           
           // Lancement au chargement du DOM
           moviesPage.init();
           
        ============================================
        APPELS API TMDB
        ============================================
        
        Endpoint utilis√© : /discover/movie
        
        URL compl√®te :
        https://api.themoviedb.org/v3/discover/movie
          ?api_key=VOTRE_CLE
          &language=fr-FR
          &sort_by=popularity.desc
          &page=1
          &include_adult=false
          &include_video=false
        
        Param√®tres :
        - api_key : Cl√© d'authentification TMDB
        - language : fr-FR pour contenu en fran√ßais
        - sort_by : popularity.desc (du plus au moins populaire)
        - page : Num√©ro de page (1-500)
        - include_adult : false (pas de contenu adulte)
        
        R√©ponse JSON :
        {
          "page": 1,
          "results": [
            {
              "id": 550,
              "title": "Fight Club",
              "original_title": "Fight Club",
              "poster_path": "/pB8BM7pdSp6B6Ih7QZ4DrQ3PmJK.jpg",
              "backdrop_path": "/fCayJrkfRaCRCTh8GqN30f8oyQF.jpg",
              "overview": "Le narrateur, employ√© d'une compagnie...",
              "release_date": "1999-10-15",
              "vote_average": 8.433,
              "vote_count": 26280,
              "genre_ids": [18, 53, 35],
              "adult": false,
              "popularity": 61.416
            },
            // ... 19 autres films
          ],
          "total_pages": 500,
          "total_results": 10000
        }
        
        Construction URL image :
        Base URL : https://image.tmdb.org/t/p/
        Taille : w500 (500px de large)
        Path : /pB8BM7pdSp6B6Ih7QZ4DrQ3PmJK.jpg
        URL finale : https://image.tmdb.org/t/p/w500/pB8BM7pdSp6B6Ih7QZ4DrQ3PmJK.jpg
        
        ============================================
        PERFORMANCES ET OPTIMISATIONS
        ============================================
        
        1. Chargement asynchrone (async/await)
           - Interface non bloqu√©e pendant l'appel API
           - Message de chargement visible
        
        2. Lazy loading des images (optionnel)
           - loading="lazy" sur balises <img>
           - Images charg√©es uniquement si visibles
        
        3. Cache navigateur
           - Images mises en cache automatiquement
           - Chargement instantan√© si d√©j√† visit√©
        
        4. D√©l√©gation d'√©v√©nements
           - Un seul listener sur document
           - Pas de listener par carte (20 √©conomis√©s)
        
        5. Gestion des erreurs
           - try/catch pour appels API
           - Messages d'erreur utilisateur
           - Fallback en cas d'√©chec
    -->
    <script type="module" src="js/movies.js"></script>
</body>
</html>
